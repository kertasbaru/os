#!/bin/bash
# //====================================================
# //  Newbie Store - Copy 2024
# //====================================================
# //  System Request : DEB 9-12 / UBUNTU 18-24
# //  Author         : Kurniawan Setiadi
# //  Develop        : Newbie Store
# //  email          : Newbiestore09@gmail.com
# //  telegram       : https://t.me/newbie_store24
# //====================================================
source /etc/warna
REDBG="\033[41m"   
WHITEBLD="\033[1;37m"
WHITE="\033[1;37m" 
NC="\033[0m"    
GREEN="\033[96;1m"
REDBLD="\033[0m\033[91;1m"
Green="\e[92;1m"
RED="\033[1;31m"
YELLOW="\033[33m"
BLUE="\033[36m"
FONT="\033[0m"
GREENBG="\033[42;37m"
nama=$(cat /etc/xray/username)
print_rainbow() {
    local text="$1"
    local warna_file="/etc/warna"

    # Inisialisasi warna default
    local start_r=0 start_g=255 start_b=150
    local mid_r=0 mid_g=150 mid_b=255
    local end_r=0 end_g=255 end_b=150

    # Fungsi untuk membaca nilai numerik dari file
    function get_value() {
        local key="$1"
        local value=$(grep -E "^$key=" "$warna_file" | cut -d'=' -f2 | tr -d '[:space:]')
        echo "${value:-0}"
    }

    # Jika file warna ada, baca isinya
    if [[ -f "$warna_file" ]]; then
        start_r=$(get_value "start_r")
        start_g=$(get_value "start_g")
        start_b=$(get_value "start_b")

        mid_r=$(get_value "mid_r")
        mid_g=$(get_value "mid_g")
        mid_b=$(get_value "mid_b")

        end_r=$(get_value "end_r")
        end_g=$(get_value "end_g")
        end_b=$(get_value "end_b")
    fi

    # Jalankan awk dengan warna yang sudah dimuat dari file
    echo "$text" | awk -v start_r="$start_r" -v start_g="$start_g" -v start_b="$start_b" \
                        -v mid_r="$mid_r" -v mid_g="$mid_g" -v mid_b="$mid_b" \
                        -v end_r="$end_r" -v end_g="$end_g" -v end_b="$end_b" '
    {
        len = length($0);
        for (i = 1; i <= len; i++) {
            progress = (i - 1) / (len - 1);
            if (progress < 0.5) {
                factor = progress * 2;
                r = int((1 - factor) * start_r + factor * mid_r);
                g = int((1 - factor) * start_g + factor * mid_g);
                b = int((1 - factor) * start_b + factor * mid_b);
            } else {
                factor = (progress - 0.5) * 2;
                r = int((1 - factor) * mid_r + factor * end_r);
                g = int((1 - factor) * mid_g + factor * end_g);
                b = int((1 - factor) * mid_b + factor * end_b);
            }
            printf "\033[38;2;%d;%d;%dm%s", r, g, b, substr($0, i, 1);
        }
        print "\033[0m";
    }'
}
garis(){
print_rainbow " ────────────────────────────────────────────────"
}
garis_tebal(){
print_rainbow " ════════════════════════════════════════════════"
}
garis_bawah(){
print_rainbow " └──────────────────────────────────────────────┘"
}
garis_atas(){
print_rainbow " ┌──────────────────────────────────────────────┐"
}
center() {
    BOX_WIDTH=48
    TEXT="$1"
    TEXT_LENGTH=${#TEXT}
    TEXT_CLEAN=$(printf "${WHITEBLD}$TEXT" | sed 's/\x1b\[[0-9;]*m//g')
    TEXT_LENGTH=${#TEXT_CLEAN}
    # Hitung padding
    LEFT_PADDING=$(( (BOX_WIDTH - TEXT_LENGTH) / 2 ))
    RIGHT_PADDING=$(( BOX_WIDTH - TEXT_LENGTH - LEFT_PADDING ))

    # Cetak dengan warna menggunakan printf
    printf "%*s%s%*s\n" "$LEFT_PADDING" "" "$TEXT" "$RIGHT_PADDING" ""
}

function Sc_Credit(){
BOX_WIDTH=48
TEXT="SCRIPT BY $nama"
TEXT_LENGTH=${#TEXT}
LEFT_PADDING=$(( (BOX_WIDTH - TEXT_LENGTH) / 2 ))
RIGHT_PADDING=$(( BOX_WIDTH - TEXT_LENGTH - LEFT_PADDING ))
LEFT_SPACE=$(printf '%*s' $LEFT_PADDING '')
RIGHT_SPACE=$(printf '%*s' $RIGHT_PADDING '')
print_rainbow " ════════════════════════════════════════════════"
print_rainbow " ${LEFT_SPACE}${TEXT}${RIGHT_SPACE}"
print_rainbow " ════════════════════════════════════════════════"
}
function Newbie_Banner() {
clear
BOX_WIDTH=48
TEXT="[ CHANGE WARNA GRADASI ]"
TEXT_LENGTH=${#TEXT}
LEFT_PADDING=$(( (BOX_WIDTH - TEXT_LENGTH) / 2 ))
RIGHT_PADDING=$(( BOX_WIDTH - TEXT_LENGTH - LEFT_PADDING ))
LEFT_SPACE=$(printf '%*s' $LEFT_PADDING '')
RIGHT_SPACE=$(printf '%*s' $RIGHT_PADDING '')
print_rainbow " ════════════════════════════════════════════════"
print_rainbow " ${LEFT_SPACE}${TEXT}${RIGHT_SPACE}"
print_rainbow " ════════════════════════════════════════════════"
}

# Fungsi untuk menampilkan pilihan menu
show_menu() {
Newbie_Banner
    echo "Pilih warna yang ingin diubah:"
    echo "1) Start RGB (Custom)"
    echo "2) Mid RGB (Custom)"
    echo "3) End RGB (Custom)"
    echo "4) Pilih preset warna"
    echo "5) Kembali Ke Menu"
garis_tebal
}

# Fungsi untuk mengganti nilai warna RGB
change_color() {
    local color_name=$1
    echo "Masukkan nilai RGB untuk ${color_name} (misal: 255 0 0):"
    read -p "R: " r
    read -p "G: " g
    read -p "B: " b

    # Menggunakan sed untuk mengganti nilai tanpa menghapus nilai lain
    if [ "$color_name" == "start" ]; then
        sed -i "s/^start_r=.*/start_r=$r/" /etc/warna
        sed -i "s/^start_g=.*/start_g=$g/" /etc/warna
        sed -i "s/^start_b=.*/start_b=$b/" /etc/warna
    elif [ "$color_name" == "mid" ]; then
        sed -i "s/^mid_r=.*/mid_r=$r/" /etc/warna
        sed -i "s/^mid_g=.*/mid_g=$g/" /etc/warna
        sed -i "s/^mid_b=.*/mid_b=$b/" /etc/warna
    elif [ "$color_name" == "end" ]; then
        sed -i "s/^end_r=.*/end_r=$r/" /etc/warna
        sed -i "s/^end_g=.*/end_g=$g/" /etc/warna
        sed -i "s/^end_b=.*/end_b=$b/" /etc/warna
    fi

    echo "Warna ${color_name} berhasil diubah menjadi RGB($r, $g, $b)"
}
# Fungsi untuk mengganti warna dengan preset gradasi 3 warna
choose_preset() {
Newbie_Banner
    echo "Pilih preset gradasi warna 3 warna:"
    echo "1) Putih-Merah-Kuning       11) Pink-Biru-Putih"
    echo "2) Biru-Hijau-Kuning        12) Hijau-Kuning-Putih"
    echo "3) Merah-Hijau-Biru         13) Biru-Hitam-Putih"
    echo "4) Oranye-Merah-Biru        14) Oranye-Merah-Putih"
    echo "5) Hijau-Cyan-Magenta       15) Merah-Kuning-Hitam"
    echo "6) Hitam-Merah-Kuning       16) Biru-Putih-Hijau"
    echo "7) Ungu-Biru-Hijau          17) Cyan-Merah-Oranye"
    echo "8) Putih-Hitam-Abu-abu      18) Hitam-Kuning-Hijau"
    echo "9) Merah-Kuning-Biru        19) Putih-Biru-Merah"
    echo "10) Kuning-Hijau-Biru       20) Ungu-Hijau-Putih"
    echo "                        21) Kembali-menu utama"
	Sc_Credit
    read -p "Pilih preset gradasi warna: " choice
    case $choice in
        1) echo "Memilih  Putih-Merah-Kuning"
           start_r=255; start_g=255; start_b=255
           mid_r=255; mid_g=0; mid_b=0
           end_r=255; end_g=255; end_b=0
           ;;
        2) echo "Memilih  Biru-Hijau-Kuning"
           start_r=0; start_g=0; start_b=255
           mid_r=0; mid_g=255; mid_b=0
           end_r=255; end_g=255; end_b=0
           ;;
        3) echo "Memilih  Merah-Hijau-Biru"
           start_r=255; start_g=0; start_b=0
           mid_r=0; mid_g=255; mid_b=0
           end_r=0; end_g=0; end_b=255
           ;;
        4) echo "Memilih  Oranye-Merah-Biru"
           start_r=255; start_g=165; start_b=0
           mid_r=255; mid_g=0; mid_b=0
           end_r=0; end_g=0; end_b=255
           ;;
        5) echo "Memilih  Hijau-Cyan-Magenta"
           start_r=0; start_g=255; start_b=0
           mid_r=0; mid_g=255; mid_b=255
           end_r=255; end_g=0; end_b=255
           ;;
        6) echo "Memilih  Hitam-Merah-Kuning"
           start_r=0; start_g=0; start_b=0
           mid_r=255; mid_g=0; mid_b=0
           end_r=255; end_g=255; end_b=0
           ;;
        7) echo "Memilih  Ungu-Biru-Hijau"
           start_r=255; start_g=0; start_b=255
           mid_r=0; mid_g=0; mid_b=255
           end_r=0; end_g=255; end_b=0
           ;;
        8) echo "Memilih  Putih-Hitam-Abu-abu"
           start_r=255; start_g=255; start_b=255
           mid_r=128; mid_g=128; mid_b=128
           end_r=0; end_g=0; end_b=0
           ;;
        9) echo "Memilih  Merah-Kuning-Biru"
           start_r=255; start_g=0; start_b=0
           mid_r=255; mid_g=255; mid_b=0
           end_r=0; end_g=0; end_b=255
           ;;
        10) echo "Memilih  Kuning-Hijau-Biru"
            start_r=255; start_g=255; start_b=0
            mid_r=0; mid_g=255; mid_b=0
            end_r=0; end_g=0; end_b=255
            ;;
        11) echo "Memilih  Pink-Biru-Putih"
            start_r=255; start_g=105; start_b=180
            mid_r=0; mid_g=0; mid_b=255
            end_r=255; end_g=255; end_b=255
            ;;
        12) echo "Memilih  Hijau-Kuning-Putih"
            start_r=0; start_g=255; start_b=0
            mid_r=255; mid_g=255; mid_b=0
            end_r=255; end_g=255; end_b=255
            ;;
        13) echo "Memilih  Biru-Hitam-Putih"
            start_r=0; start_g=0; start_b=255
            mid_r=0; mid_g=0; mid_b=0
            end_r=255; end_g=255; end_b=255
            ;;
        14) echo "Memilih  Oranye-Merah-Putih"
            start_r=255; start_g=165; start_b=0
            mid_r=255; mid_g=0; mid_b=0
            end_r=255; end_g=255; end_b=255
            ;;
        15) echo "Memilih  Merah-Kuning-Hitam"
            start_r=255; start_g=0; start_b=0
            mid_r=255; mid_g=255; mid_b=0
            end_r=0; end_g=0; end_b=0
            ;;
        16) echo "Memilih  Biru-Putih-Hijau"
            start_r=0; start_g=0; start_b=255
            mid_r=255; mid_g=255; mid_b=255
            end_r=0; end_g=255; end_b=0
            ;;
        17) echo "Memilih  Cyan-Merah-Oranye"
            start_r=0; start_g=255; start_b=255
            mid_r=255; mid_g=0; mid_b=0
            end_r=255; end_g=165; end_b=0
            ;;
        18) echo "Memilih  Hitam-Kuning-Hijau"
            start_r=0; start_g=0; start_b=0
            mid_r=255; mid_g=255; mid_b=0
            end_r=0; end_g=255; end_b=0
            ;;
        19) echo "Memilih  Putih-Biru-Merah"
            start_r=255; start_g=255; start_b=255
            mid_r=0; mid_g=0; mid_b=255
            end_r=255; end_g=0; end_b=0
            ;;
        20) echo "Memilih  Ungu-Hijau-Putih"
            start_r=255; start_g=0; start_b=255
            mid_r=0; mid_g=255; mid_b=0
            end_r=255; end_g=255; end_b=255
            ;;
        21) return
            ;;
        *) echo "Pilihan tidak valid."
            return
            ;;
    esac
    # Menyimpan preset gradasi warna-/etc/warna
    echo "start_r=$start_r" > /etc/warna
    echo "start_g=$start_g" >> /etc/warna
    echo "start_b=$start_b" >> /etc/warna
    echo "mid_r=$mid_r" >> /etc/warna
    echo "mid_g=$mid_g" >> /etc/warna
    echo "mid_b=$mid_b" >> /etc/warna
    echo "end_r=$end_r" >> /etc/warna
    echo "end_g=$end_g" >> /etc/warna
    echo "end_b=$end_b" >> /etc/warna
    echo "Warna preset berhasil diterapkan!"
}

# Menu utama
while true; do
    show_menu
    read -p "Pilih opsi (1-5): " option
    case $option in
        1) change_color "start";;
        2) change_color "mid";;
        3) change_color "end";;
        4) choose_preset;;
        5) clear ; menu ; break;;
        *) echo "Pilihan tidak valid."; continue;;
    esac
done